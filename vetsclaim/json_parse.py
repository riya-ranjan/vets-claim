from openai import OpenAI
import json

import pdf_filler

#get json file in

def main():
    client = OpenAI()

    with open('./history.json') as json_file:
        message_history = json.load(json_file)

    with open('../claims_db/prompts.json') as json_file2:
        message_fields = json.load(json_file2)

    #message input:
    my_message = str(message_history) + 'can you add the information in the above message to the relevant fields based on these fields as a JSON file.' + 'DO NOT EDIT THE FIELD NAMES OR ELSE I WILL DIE: ' + 'FIELDS: ' + '\"\"\"'
    my_message += "VA_File_Number[0]: \n" + "Email_Address_Optional[0] \n" + "Veteran_Service_Member_First_Name[0]\n" + "Veteran_Service_Member_Last_Name[0]\n" + "Veteran_Service_Member_Middle_Initial[0]\n" + "SocialSecurityNumber_FirstThreeNumbers[0]\n" + "SocialSecurityNumber_SecondTwoNumbers[0]\n" + "SocialSecurityNumber_LastFourNumbers[0]\n" + "Date_Of_Birth_Month[0]\n" + "Date_Of_Birth_Day[0]\n"+"Date_Of_Birth_Year[0]\n"+"CurrentMailingAddress_NumberAndStreet[0]\n" +"CurrentMailingAddress_ApartmentOrUnitNumber[0]\n"+"CurrentMailingAddress_City[0]\n"+"CurrentMailingAddress_StateOrProvince[0]\n"+"CurrentMailingAddress_Country[0]\n"+"CurrentMailingAddress_ZIPOrPostalCode_FirstFiveNumbers[0]\n"+"CurrentMailingAddress_ZIPOrPostalCode_LastFourNumbers[0]\n"+"New_Address_NumberAndStreet[0]\n"+"New_Address_ApartmentOrUnitNumber[0]\n"+"New_Address_City[0]\n"+"New_Address_StateOrProvince[0]\n"+"New_Address_Country[0]\n"+ "New_Address_ZIPOrPostalCode_FirstFiveNumbers[0]\n"
    my_message += "New_Address_ZIPOrPostalCode_LastFourNumbers[0]\n"+"Veterans_Service_Number_If_Applicable[0]\n"+ "BDD_Claims_Only__Provide_The_Date_Or_Anticipated_Date_Of_Release_From_Active_Duty_Month[0]\n"+ "BDD_Claims_Only_Provide_The_Date_Or_Anticipated_Date_Of_Release_From_Active_Duty_Year[0]\n"+ "Beginning_Date_Month[0]\n"+ "Beginning_Date_Day[0]\n"+ "Beginning_Date_Year[0]\n"+ "Ending_Date_Month[0]\n"+ "Ending_Date_Day[0]\n"+ "Ending_Date_Year[0]\n"+ "Daytime_Phone_Number_Area_Code[0]\n"+ "Telephone_Middle_Three_Numbers[0]\n"+ "Telephone_Last_Four_Numbers[0]\n"+ "BDD_Claims_Only__Provide_The_Date_Or_Anticipated_Date_Of_Release_From_Active_Duty_Day[0\n"+ "International_Telephone_Number_If_Applicable[0]\n"+ "Email_Address_Optional[1]\n"+ "SocialSecurityNumber_FirstThreeNumbers[0].2\n"+ "SocialSecurityNumber_SecondTwoNumbers[0].2\n"
    my_message += "SocialSecurityNumber_LastFourNumbers[0].2\n"+ "Telephone_Number_Area_Code[0]\n"+ "Telephone_Middle_Three_Numbers[0].2\n"+ "Telephone_Last_Four_Numbers[0].2\n"+ "International_Telephone_Number_If_Applicable[0].2\n"+ "From_Date_Month[0]\n"+ "From_Date_Year[0]\n"+ "List_Other_Locations_Where_You_Served[0]\n"+ "Provide_Additional_Dates_And_Locations_Of_Potential_Exposure[0]\n"+ "POINT_OF_CONTACT[0]\n"+ "To_Date_Year[0]\n"+ "To_Date_Month[0]\n"+ "From_Date_Month[1]\n"+ "From_Date_Year[1]\n"+ "To_Date_Year[1]\n"+ "To_Date_Month[1]\n"+ "From_Date_Month[2]\n"+ "From_Date_Year[2]\n"+ "To_Date_Year[2]\n"+ "To_Date_Month[2]\n"+ "OTHER_SPECIFY[0]\n"+ "OTHER_SPECIFY[1]\n"+ "Other_Specify[0]\n"+ "SocialSecurityNumber_FirstThreeNumbers[1]\n"+ "SocialSecurityNumber_SecondTwoNumbers[1]\n"+ "SocialSecurityNumber_LastFourNumbers[1]\n"+ "CURRENTDISABILITY[0]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[0]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[0]\n"+ "Date_Disability_Began_Or_Worsened[0]\n"+ "Date12[0]\n"+ "Date12[1]\n"+ "Date12[2]\n"+ "Date12[3]\n"+ "Date12[4]\n"+ "Date12[5]\n"+ "Date12[6]\n"+ "Date12[7]\n"+ "Date12[8]\n"+ "Date12[9]\n"+ "Date12[10]\n"+ "Date12[11]\n"+ "Date12[12]\n"+ "Date12[13]\n"+ "CURRENTDISABILITY[1]\n"+ "CURRENTDISABILITY[2]\n"+ "CURRENTDISABILITY[3]\n"+ "CURRENTDISABILITY[4]\n"+ "CURRENTDISABILITY[5]\n"+ "CURRENTDISABILITY[6]\n"+ "CURRENTDISABILITY[7]\n"+ "CURRENTDISABILITY[8]\n"+ "CURRENTDISABILITY[9]\n"+ "CURRENTDISABILITY[10]\n"+ "CURRENTDISABILITY[11]\n"+ "CURRENTDISABILITY[12]\n"+ "CURRENTDISABILITY[13]\n"+ "CURRENTDISABILITY[14]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[1]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[2]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[3]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[4]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[5]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[6]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[7]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[8]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[9]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[10]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[11]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[12]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[13]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[14]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[1]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[2]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[3]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[4]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[5]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[6]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[7]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[8]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[9]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[10]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[11]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[12]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[13]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[14]\n"+ "Date_Of_Treatment_Year[0]\n"+ "Date_Of_Treatment_Month[0]\n"+ "Date_Of_Treatment_Year[1]\n"+ "Date_Of_Treatment_Month[1]\n"+ "Date_Of_Treatment_Year[2]\n"+ "Date_Of_Treatment_Month[2]\n"+ "Enter_Disability_Treated_And_Name_And_Location_Of_Treatment_Facility[0]\n"+ "Enter_Disability_Treated_And_Name_And_Location_Of_Treatment_Facility[1]\n"+ "Enter_Disability_Treated_And_Name_And_Location_Of_Treatment_Facility[2]\n"+ "SocialSecurityNumber_FirstThreeNumbers[2]\n"+ "SocialSecurityNumber_SecondTwoNumbers[2]\n"+ "SocialSecurityNumber_LastFourNumbers[2]\n"+ "List_Other_Name_You_Served_Under[0]\n"+ "EntryDate_Month[0]\n"+ "MostRecentActiveServiceEntryDate_Day[0]\n"+ "EntryDate_Year[0]\n"+ "ObligationTermOfService_Month[0]\n"+ "ObligationTermOfService_Day[0]\n"+ "ObligationTermOfService_Year[0]\n"+ "ObligationTermOfService_Month[1]\n"+ "ObligationTermOfService_Day[1]\n"+ "ObligationTermOfService_Year[1]\n"+ "DateOfActivation_Month[0]\n"+ "DateOfActivation_Day[0]\n"+ "DateOfActivation_Year[0]\n"+ "AnticipatedSeparationDate_Month[0]\n"+ "AnticipatedSeparationDate_Day[0]\n"+ "AnticipatedSeparationDate_Year[0]\n"+ "DatesOfConfinement_Month[0]\n"+ "DatesOfConfinement_Day[0]\n"+ "DatesOfConfinement_Year[0]\n"+ "DatesOfConfinement_Month[1]\n"+ "DatesOfConfinement_Day[1]\n"+ "DatesOfConfinement_Year[1]\n"+ "DatesOfConfinement_Month[2]\n"+ "DatesOfConfinement_Day[2]\n"+ "DatesOfConfinement_Year[2]\n"+ "DatesOfConfinement_Month[3]\n"+ "DatesOfConfinement_Day[3]\n"+ "DatesOfConfinement_Year[3]\n"+ "PlaceOfLastOrAnticipatedSeparation[0]\n"+ "PlaceOfLastOrAnticipatedSeparation[1]\n"+ "ExitDate_Month[0]\n"+ "ExitDate_Day[0]\n"+ "ExitDate_Year[0]\n"+ "AdditionalPeriodsOfService_Month[0]\n"+ "AdditionalPeriodsOfService_Day[0]\n"+ "AdditionalPeriodsOfService_Year[0]\n"+ "AdditionalPeriodsOfService_Month[1]\n"+ "AdditionalPeriodsOfService_Day[1]\n"+ "AdditionalPeriodsOfService_Year[1]\n"+ "Monthly_Amount[0]\n"+ "Monthly_Amount[1]\n"+ "CURRENT_OR_LAST_ASSIGNED_NAME_AND_ADDRESS_OF_UNIT[0]\n"+ "Current_Or_Assigned_Phone_Number_Of_Unit_Include_Area_Code[0]\n"+ "EXPLAIN[0]\n"+ "Routing_Or_Transit_Number[0]\n"+ "Account_Number[0]\n"+ "DatePaymentReceived_Month[0]\n"+ "DatePaymentReceived_Day[0]\n"+ "DatePaymentReceived_Year[0]\n"+ "Amount_Received_Last_Three_Digits[0]\n"+ "Amount_Received_First_Three_Digits[0]\n"+ "SocialSecurityNumber_FirstThreeNumbers[3]\n"+ "SocialSecurityNumber_SecondTwoNumbers[3]\n"+ "SocialSecurityNumber_LastFourNumbers[3]\n"+ "Date_Signed_Month[0]\n"+ "Date_Signed_Day[0]\n"+ "Date_Signed_Year[0]\n"+ "Print_Name_And_Address_Of_Witness[0]\n"+ "Print_Name_And_Address_Of_Witness[1]\n"+ "NAME_OF_FINANCIAL_INSTITUTION[0]\n"+ "Date_Signed_Year[1]\n"+ "Date_Signed_Day[1]\n"+ "Date_Signed_Month[1]\n"+ "Date_Signed_Month[2]\n"+ "Date_Signed_Day[2]\n"+ "Date_Signed_Year[2]\n"+ "SocialSecurityNumber_FirstThreeNumbers[4]\n"+ "SocialSecurityNumber_SecondTwoNumbers[4]\n"+ "SocialSecurityNumber_LastFourNumbers[4]\n"+ "SocialSecurityNumber_FirstThreeNumbers[5]\n"+ "SocialSecurityNumber_SecondTwoNumbers[5]\n"+ "SocialSecurityNumber_LastFourNumbers[5]\n"+ "CURRENTDISABILITY[15]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[15]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[15]\n"+ "Date_Disability_Began_Or_Worsened[1]\n"+ "Date12[14]\n"+ "Date12[15]\n"+ "Date12[16]\n"+ "Date12[17]\n"+ "Date12[18]\n"+ "Date12[19]\n"+ "Date12[20]\n"+ "Date12[21]\n"+ "Date12[22]\n"+ "Date12[23]\n"+ "Date12[24]\n"+ "Date12[25]\n"+ "Date12[26]\n"+ "Date12[27]\n"+ "CURRENTDISABILITY[16]\n"+ "CURRENTDISABILITY[17]\n"+ "CURRENTDISABILITY[18]\n"+ "CURRENTDISABILITY[19]\n"+ "CURRENTDISABILITY[20]\n"+ "CURRENTDISABILITY[21]\n"+ "CURRENTDISABILITY[22]\n"+ "CURRENTDISABILITY[23]\n"+ "CURRENTDISABILITY[24]\n"+ "CURRENTDISABILITY[25]\n"+ "CURRENTDISABILITY[26]\n"+ "CURRENTDISABILITY[27]\n"+ "CURRENTDISABILITY[28]\n"+ "CURRENTDISABILITY[29]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[16]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[17]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[18]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[19]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[20]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[21]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[22]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[23]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[24]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[25]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[26]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[27]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[28]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[29]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[16]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[17]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[18]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[19]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[20]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[21]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[22]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[23]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[24]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[25]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[26]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[27]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[28]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[29]\n"+ "Date12[28]\n"+ "Date12[29]\n"+ "Date12[30]\n"+ "Date12[31]\n"+ "Date12[32]\n"+ "CURRENTDISABILITY[30]\n"+ "CURRENTDISABILITY[31]\n"+ "CURRENTDISABILITY[32]\n"+ "CURRENTDISABILITY[33]\n"+ "CURRENTDISABILITY[34]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[30]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[31]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[32]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[33]\n"+ "Specify_Type_Of_Exposure_Event_Or_Injury[34]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[30]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[31]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[32]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[33]\n"+ "ExplainHowDisabilityRelatesToEvent_Exposure_Injury[34]\n" + "\"\"\""

    # output = eval(client, messages=[
    #     dict(role="user", content=my_message),
    # ])

    output = client.chat.completions.create(
        model="gpt-4-turbo-preview",
        messages=[
            {"role": "system", "content": "You are a helpful assistant filling in a JSON template."},
            {"role": "user", "content": my_message},
        ],
        response_format={"type": "json_object"}
    )

    print(output)
    with open("../claims_db/vet-info.json", 'w') as file:
        file.write(output.choices[0].message.content[7:-3])

    

    exec(open("pdf_filler.py").read())

    # output_dump = json.loads(output.choices[0].message.content)
    # print(json.dumps(output_dump, indent=2))

# async def eval(client, messages):
#   return await client.chat.completions.create(
#       messages=messages,
#       model="gpt-4-0125-preview",
#       response_format={"type": "json_object"},
#       n=2
#   )

if __name__ == "__main__":
    main()